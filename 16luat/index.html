<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng Suy Di·ªÖn AI - Triangle Expert System</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Sidebar Menu -->
        <div class="sidebar">
            <h2>üß† H·ªá Th·ªëng AI</h2>
            <ul>
                <li class="menu-item active" data-target="rules-section">üìö Qu·∫£n l√Ω Lu·∫≠t</li>
                <li class="menu-item" data-target="fpg-section">üìä Bi·ªÉu ƒë·ªì FPG</li>
                <li class="menu-item" data-target="rpg-section">üîÑ Bi·ªÉu ƒë·ªì RPG</li>
                <li class="menu-item" data-target="forward-section">‚û°Ô∏è Suy di·ªÖn Ti·∫øn</li>
                <li class="menu-item" data-target="backward-section">‚¨ÖÔ∏è Suy di·ªÖn L√πi</li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            
            <!-- 1. QU·∫¢N L√ù LU·∫¨T -->
            <div id="rules-section" class="content-section active">
                <h1>üìö Qu·∫£n l√Ω C∆° s·ªü Tri th·ª©c</h1>
                <div class="toolbar">
                    <label for="fileInput" class="btn btn-primary">üìÅ T·∫£i l√™n file lu·∫≠t (Excel/CSV)</label>
                    <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" onchange="taiLenTapLuat(event)" style="display: none;">
                    <button class="btn btn-secondary" onclick="themLuatMoi()">‚ûï Th√™m lu·∫≠t</button>
                    <input type="text" class="search-box" placeholder="üîç T√¨m ki·∫øm lu·∫≠t..." id="searchBox" onkeyup="searchRules()">
                </div>
                <div id="uploadStatus" class="upload-status"></div>
                
                <table id="ruleTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>V·∫ø tr√°i</th>
                            <th>V·∫ø ph·∫£i</th>
                            <th>Ghi ch√∫ (Note)</th>
                            <th>H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- 2. BI·ªÇU ƒê·ªí FPG -->
            <div id="fpg-section" class="content-section">
                <h1>üìä Bi·ªÉu ƒë·ªì FPG (Forward Production Graph)</h1>
                
                <div class="draw-section">
                    <div class="info-box">
                        <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> Vui l√≤ng t·∫£i file lu·∫≠t v√† ch·∫°y suy di·ªÖn tr∆∞·ªõc khi v·∫Ω bi·ªÉu ƒë·ªì FPG.
                    </div>
                    <button class="btn btn-draw" onclick="generateFPG()">üé® V·∫Ω bi·ªÉu ƒë·ªì FPG</button>
                </div>
                
                <div id="fpgLoading" class="loading">ƒêang t·∫°o bi·ªÉu ƒë·ªì FPG...</div>
                <div id="fpgContainer" class="chart-container">
                    <p class="placeholder">üìä Nh·∫•n n√∫t "V·∫Ω bi·ªÉu ƒë·ªì FPG" ƒë·ªÉ hi·ªÉn th·ªã</p>
                </div>
            </div>

            <!-- 3. BI·ªÇU ƒê·ªí RPG -->
            <div id="rpg-section" class="content-section">
                <h1>üîÑ Bi·ªÉu ƒë·ªì RPG (Rules Precedence Graph)</h1>
                
                <div class="draw-section">
                    <div class="info-box">
                        <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> Vui l√≤ng t·∫£i file lu·∫≠t tr∆∞·ªõc khi v·∫Ω bi·ªÉu ƒë·ªì RPG.
                    </div>
                    <button class="btn btn-draw" onclick="generateRPG()">üé® V·∫Ω bi·ªÉu ƒë·ªì RPG</button>
                </div>
                
                <div id="rpgLoading" class="loading">ƒêang t·∫°o bi·ªÉu ƒë·ªì RPG...</div>
                <div id="rpgContainer" class="chart-container">
                    <p class="placeholder">üìä Nh·∫•n n√∫t "V·∫Ω bi·ªÉu ƒë·ªì RPG" ƒë·ªÉ hi·ªÉn th·ªã</p>
                </div>
            </div>

            <!-- 4. SUY DI·ªÑN TI·∫æN -->
            <div id="forward-section" class="content-section">
                <h1>‚û°Ô∏è Suy di·ªÖn Ti·∫øn (Forward Chaining)</h1>
                
                <div class="inference-panel">
                    <div class="inference-controls">
                        <div class="control-group">
                            <label for="giathiet">Gi·∫£ thi·∫øt ban ƒë·∫ßu (GT):</label>
                            <input type="text" id="giathiet" placeholder="V√≠ d·ª•: a, b, c">
                            <small>Nh·∫≠p c√°c fact ban ƒë·∫ßu m√† b·∫°n ƒë√£ bi·∫øt</small>
                        </div>
                        
                        <div class="control-group">
                            <label for="ketqua">K·∫øt lu·∫≠n c·∫ßn t√¨m (KL):</label>
                            <input type="text" id="ketqua" placeholder="V√≠ d·ª•: S">
                            <small>Nh·∫≠p k·∫øt lu·∫≠n b·∫°n mu·ªën ch·ª©ng minh</small>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="suydienChiTiet()">üöÄ Th·ª±c hi·ªán suy di·ªÖn ti·∫øn</button>
                            <button class="btn btn-secondary" onclick="resetInference()">üîÑ ƒê·∫∑t l·∫°i</button>
                        </div>

                        <div class="info-box" style="margin-top: 20px;">
                            <strong>üí° Chi·∫øn l∆∞·ª£c:</strong> Forward Chaining - t·ª´ gi·∫£ thi·∫øt t√¨m ƒë·∫øn k·∫øt lu·∫≠n
                        </div>
                    </div>
                    
                    <div class="inference-results">
                        <h3>K·∫øt qu·∫£ suy di·ªÖn ti·∫øn</h3>
                        <div id="ketQuaSuyDienChiTiet">
                            Nh·∫≠p gi·∫£ thi·∫øt v√† k·∫øt qu·∫£ c·∫ßn t√¨m, sau ƒë√≥ nh·∫•n "Th·ª±c hi·ªán suy di·ªÖn ti·∫øn"...
                        </div>
                    </div>
                </div>

                <div id="bang-qua-trinh">
                    <h2>üìã B·∫£ng Qu√° Tr√¨nh Suy Di·ªÖn Ti·∫øn</h2>
                    <table id="process-table">
                        <thead>
                            <tr>
                                <th>B∆∞·ªõc</th>
                                <th>Lu·∫≠t √°p d·ª•ng</th>
                                <th>THOA</th>
                                <th>TG</th>
                                <th>R</th>
                                <th>VET</th>
                                <th>Ghi ch√∫</th>
                            </tr>
                        </thead>
                        <tbody id="process-table-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- 5. SUY DI·ªÑN L√ôI -->
            <div id="backward-section" class="content-section">
                <h1>‚¨ÖÔ∏è Suy di·ªÖn L√πi (Backward Chaining)</h1>
                
                <div class="inference-panel">
                    <div class="inference-controls">
                        <div class="control-group">
                            <label for="giathiet_backward">Gi·∫£ thi·∫øt ban ƒë·∫ßu (GT):</label>
                            <input type="text" id="giathiet_backward" placeholder="V√≠ d·ª•: a, b, c">
                            <small>Nh·∫≠p c√°c fact ban ƒë·∫ßu ƒë√£ bi·∫øt</small>
                        </div>
                        
                        <div class="control-group">
                            <label for="ketqua_backward">K·∫øt lu·∫≠n c·∫ßn ch·ª©ng minh (KL):</label>
                            <input type="text" id="ketqua_backward" placeholder="V√≠ d·ª•: S">
                            <small>Nh·∫≠p k·∫øt lu·∫≠n c·∫ßn ch·ª©ng minh b·∫±ng suy di·ªÖn l√πi</small>
                        </div>
                        
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="suydienLui()">üöÄ Th·ª±c hi·ªán suy di·ªÖn l√πi</button>
                            <button class="btn btn-secondary" onclick="resetBackwardInference()">üîÑ ƒê·∫∑t l·∫°i</button>
                        </div>

                        <div class="info-box" style="margin-top: 20px;">
                            <strong>üí° M√¥ t∆° MTSD:</strong> Chi·∫øn l∆∞·ª£c THEN ‚Üí IF (t·ª´ k·∫øt lu·∫≠n t√¨m ng∆∞·ª£c v·ªÅ ti·ªÅn ƒë·ªÅ)
                        </div>
                    </div>
                    
                    <div class="inference-results">
                        <h3>K·∫øt qu·∫£ suy di·ªÖn l√πi</h3>
                        <div id="ketQuaSuyDienLui">
                            Nh·∫≠p gi·∫£ thi·∫øt v√† k·∫øt lu·∫≠n c·∫ßn ch·ª©ng minh, sau ƒë√≥ nh·∫•n "Th·ª±c hi·ªán suy di·ªÖn l√πi"...
                        </div>
                    </div>
                </div>

                <!-- Trace Visualization -->
                <div id="backward-trace-section" style="display: none; margin-top: 30px;">
                    <h2>üîç Chu·ªói Suy Di·ªÖn L√πi (Backward Trace)</h2>
                    <div id="traceContainer" class="trace-container">
                        <!-- Trace will be rendered here -->
                    </div>
                </div>

                <!-- Process Table -->
                <div id="bang-qua-trinh-backward">
                    <h2>üìã B·∫£ng Qu√° Tr√¨nh Suy Di·ªÖn L√πi</h2>
                    <table id="process-table-backward">
                        <thead>
                            <tr>
                                <th>B∆∞·ªõc</th>
                                <th>Lu·∫≠t</th>
                                <th>M·ª•c ti√™u</th>
                                <th>GT</th>
                                <th>VET</th>
                                <th>Gi·∫£i th√≠ch & C√¥ng th·ª©c</th>
                            </tr>
                        </thead>
                        <tbody id="process-table-body-backward"></tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
